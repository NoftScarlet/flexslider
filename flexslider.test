<?php

/**
 * @file
 * Test cases for Flexslider
 *
 * @author Mathew Winstone <mwinstone@coldfrontlabs.ca>
 */


class FlexsliderTestCase extends DrupalWebTestCase {
  protected $admin_user;
  protected $any_user;
  
  public static function getInfo() {
    return array(
      'name' => t('Flexslider tests'),
      'description' => t('Test the Flexslider presets, configuration options and permission controls.'),
      'group' => t('Flexslider'),
    );
  }

  function setUp() {
    parent::setUp('libraries', 'ctools', 'flexslider');
    
    // Create users
    $this->admin_user = $this->drupalCreateUser(array('administer flexslider'));
    $this->any_user = $this->drupalCreateuser(array('access administration pages'));
  }

  function testAdminAccess() {

    // Login as the admin user
    $this->drupalLogin($this->admin_user);
    
    // Load admin page
    $this->drupalGet('admin/config/media/flexslider');
    $this->assertResponse(200, t('Administrative permission allows access to administration page.'));
    
    // Logout as admin user
    $this->drupalLogout();
    
    // Login as any user
    $this->drupalLogin($this->any_user);

    // Attempt to load admin page
    $this->drupalGet('admin/config/media/flexslider');
    $this->assertResponse(403, t('Regular users do not have access to administrative pages.'));
  }
  
  function testOptionSet() {
    
    // Login with admin user
    $this->drupalLogin($this->admin_user);

    // ------------ Test Option Set Add ------------ //
    // Load create form
    $this->drupalGet('admin/config/media/flexslider/add');
    $this->assertResponse(200, t('Administrative user can reach the "Add" form.'));
    
    // Save new optionset
    $optionset = array();
    $optionset['title'] = 'testset';
    $optionset['name'] = 'testset';
    $this->drupalPost('admin/config/media/flexslider/add', $optionset, t('Create new option set'));
    $this->assertResponse(200);
    $this->assertText('Option set testset was created.', t('Successfully saved the new optionset "testset"'));

    // Attempt to save option set of the same name again

    // ------------ Test Option Set Edit ------------ //
    // Load option set edit form
    // Attempt to save each option value
    // Test saved values
    // 
    
    // ------------ Test Option Set Delete ------------ //
    // Attempt to delete an option set that exists
    // Attemp to delete an option set that doesn't exist
  }
  
}
